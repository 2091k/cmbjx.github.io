---
layout: post
title: "解包和打包中兴光猫配置文件"
subtitle: "仅低版本有效"
author: "cmbjx"
header-img: "img/home-bg-o.jpg"
header-mask: 0.4
tags:
  - 中兴
  - 光猫
---

### 获得配置文件
首先访问光猫的管理界面，一般都是：http://192.168.1.1/

输入从网上找到的登录用户名：`CMCCAdmin`，和密码：`aDm8H%MdA`。

找一个 FAT32 分区的 U 盘插到光猫背面的 USB 接口上。

然后在管理界面选择「管理」->「设备管理」->「USB备份配置」，应该会看到类似下面的界面，点击「开始备份」
![1](https://pic1.zhimg.com/80/v2-379ba8b5399b53c6104c74505e264dd4_720w.webp)
备份好了以后，拔下 U 盘放到电脑上，会看到一个名为 e8_Config_Backup 的目录，里面有一个叫 ctce8_F663N.cfg 的配置文件。

这个就是我们要处理的文件了。

### 解包

首先去下载最新的可执行版本：https://github.com/TommyLau/ztecfg/releases

[蓝奏下载地址](https://wwi.lanzoup.com/iW5hT24wxlra)

把刚才得到的配置文件复制到 ztecfg 所在的目录，打开终端或命令行，运行如下命令：
```sh
$ ./ztecfg -u ctce8_F663N.cfg

Device name: F663N

Block 1: size=65536, compressed=5724, offset=5796
Block 2: size=65536, compressed=7018, offset=12826
Block 3: size=65536, compressed=1828, offset=14666
Block 4: size=65536, compressed=2551, offset=17229
Block 5: size=65536, compressed=7136, offset=24377
Block 6: size=65536, compressed=5343, offset=29732
Block 7: size=12717, compressed=1305, offset=0

Write XML output to file "ctce8_F663N.xml"
```
得到了一个名为 ctce8_F663N.xml 的文件，就是解包出来的配置文件。

### 打包

修改完 XML 文件以后，运行下面的命令：
```sh
$ ./ztecfg.py -p ctce8_F663N.cfg ctce8_F663N.xml

Device name: F663N

Block 1: size=65536, compressed=5724, offset=5796
Block 2: size=65536, compressed=7018, offset=12826
Block 3: size=65536, compressed=1828, offset=14666
Block 4: size=65536, compressed=2551, offset=17229
Block 5: size=65536, compressed=7136, offset=24377
Block 6: size=65536, compressed=5343, offset=29732
Block 7: size=12717, compressed=1305, offset=0

Write CFG output to file "ctce8_F663N.xml.cfg"
```

程序执行后会生成一个名为 ctce8_F663N.xml.cfg 的文件，把它复制到 U 盘的e8_Config_Backup 的目录里，删除旧文件，并重命名为 ctce8_F663N.cfg。

### 写入新配置
把保存了新配置的 U 盘插到中兴的光猫上，然后打开光猫的管理界面。

选择「管理」->「设备管理」->「USB恢复配置」，勾选「启用」，然后点击「确定」。

![2](https://pic3.zhimg.com/80/v2-d8a5b55f3bc8899c57e59e4a03c6dbee_720w.webp)


